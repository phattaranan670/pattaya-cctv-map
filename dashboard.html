<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üó∫Ô∏è Dashboard ‡∏≠‡∏∏‡∏ö‡∏±‡∏ï‡∏¥‡πÄ‡∏´‡∏ï‡∏∏ - ‡∏û‡∏±‡∏ó‡∏¢‡∏≤</title>
    <script src="https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.css"/>
    <script src="https://cdn.jsdelivr.net/gh/python-visualization/folium@main/folium/templates/leaflet_heat.min.js"></script>
    <link rel="stylesheet" href="style_dash.css">
</head>
<body>
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div style="text-align: center;">
            <div class="loader"></div>
            <p style="margin-top: 20px; color: #667eea; font-weight: 600;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
            <p style="margin-top: 10px; color: #718096; font-size: 12px;" id="loadingStatus">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ API...</p>
        </div>
    </div>

    <div class="main-container">
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <button class="toggle-sidebar-btn" id="toggleSidebar">√ó</button>
                <h2>üó∫Ô∏è Dashboard ‡∏≠‡∏∏‡∏ö‡∏±‡∏ï‡∏¥‡πÄ‡∏´‡∏ï‡∏∏</h2>
                <p>‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà: ‡∏û‡∏±‡∏ó‡∏¢‡∏≤ (2022-2024)</p>
            </div>
            
            <div class="year-filter">
                <h3>üìÖ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤</h3>
                <div class="year-buttons">
                    <button class="year-btn active" data-year="all">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
                    <button class="year-btn" data-year="2022">2022</button>
                    <button class="year-btn" data-year="2023">2023</button>
                    <button class="year-btn" data-year="2024">2024</button>
                </div>
            </div>
            
            <div class="stats-grid">
                <div class="stat-card danger">
                    <div class="stat-value" id="totalAccidents">0</div>
                    <div class="stat-label">‡∏à‡∏∏‡∏î‡∏≠‡∏∏‡∏ö‡∏±‡∏ï‡∏¥‡πÄ‡∏´‡∏ï‡∏∏</div>
                </div>
                <div class="stat-card warning">
                    <div class="stat-value" id="avgPerMonth">0</div>
                    <div class="stat-label">‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</div>
                </div>
                <div class="stat-card info">
                    <div class="stat-value" id="peakMonth">-</div>
                    <div class="stat-label">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î</div>
                </div>
                <div class="stat-card success">
                    <div class="stat-value" id="trendPercent">0%</div>
                    <div class="stat-label">‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°</div>
                </div>
            </div>
            
            <div class="control-section">
                <div class="section-title">‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•</div>
                
                <div class="control-group">
                    <button id="viewAnalytics" class="btn-control btn-analytics">
                        <span>üìä</span>
                        <span>‡∏î‡∏π Analytics Dashboard</span>
                    </button>
                    <button id="toggleHeatmap" class="btn-control btn-primary">
                        <span>üî•</span>
                        <span>‡∏ã‡πà‡∏≠‡∏ô Heatmap</span>
                    </button>
                    <button id="resetView" class="btn-control btn-secondary">
                        <span>üîÑ</span>
                        <span>‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏°‡∏∏‡∏°‡∏°‡∏≠‡∏á</span>
                    </button>
                </div>
                
                <div class="control-group">
                    <label>‡∏£‡∏±‡∏®‡∏°‡∏µ: <span id="radiusValue">25</span> px</label>
                    <input type="range" id="radiusSlider" min="5" max="50" value="25">
                </div>
                
                <div class="control-group">
                    <label>‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ö‡∏•‡∏≠: <span id="blurValue">15</span></label>
                    <input type="range" id="blurSlider" min="5" max="30" value="15">
                </div>
                
                <div class="control-group">
                    <label>‡∏Ñ‡∏ß‡∏≤‡∏°‡πÇ‡∏õ‡∏£‡πà‡∏á‡πÉ‡∏™: <span id="opacityValue">60</span>%</label>
                    <input type="range" id="opacitySlider" min="10" max="100" value="60">
                </div>
            </div>
        </div>
        
        <div class="map-container">
            <button class="toggle-open-btn" id="toggleOpen">‚ò∞</button>
            <div id="map"></div>
            
            <div class="legend">
                <h5>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡∏≤‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏∏‡∏ö‡∏±‡∏ï‡∏¥‡πÄ‡∏´‡∏ï‡∏∏</h5>
                <div class="legend-gradient"></div>
                <div class="legend-labels">
                    <span>‡∏ô‡πâ‡∏≠‡∏¢</span>
                    <span>‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á</span>
                    <span>‡∏°‡∏≤‡∏Å</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Analytics Dashboard Modal -->
    <div class="dashboard-modal" id="dashboardModal">
        <div class="dashboard-content">
            <div class="dashboard-header">
                <h2>üìä Analytics Dashboard - ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏≠‡∏∏‡∏ö‡∏±‡∏ï‡∏¥‡πÄ‡∏´‡∏ï‡∏∏‡∏û‡∏±‡∏ó‡∏¢‡∏≤</h2>
                <button class="close-btn" id="closeDashboard">√ó</button>
            </div>
            <div class="dashboard-body">
                <div class="charts-grid">
                    <div class="chart-card full">
                        <h3>üìà ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏≠‡∏∏‡∏ö‡∏±‡∏ï‡∏¥‡πÄ‡∏´‡∏ï‡∏∏‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö 3 ‡∏õ‡∏µ)</h3>
                        <div class="chart-container">
                            <canvas id="yearlyComparisonChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="chart-card">
                        <h3>üç∞ ‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏≠‡∏∏‡∏ö‡∏±‡∏ï‡∏¥‡πÄ‡∏´‡∏ï‡∏∏‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏õ‡∏µ</h3>
                        <div class="chart-container">
                            <canvas id="yearPieChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="chart-card">
                        <h3>üìä ‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏£‡∏≤‡∏¢‡∏õ‡∏µ</h3>
                        <div class="chart-container">
                            <canvas id="trendChart"></canvas>
                        </div>
                    </div>
                </div>
                
                <div class="info-grid">
                    <div class="info-card">
                        <h4>üìÖ ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏£‡∏≤‡∏¢‡∏õ‡∏µ</h4>
                        <div class="info-item">
                            <span>2022</span>
                            <span id="total2022">0 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</span>
                        </div>
                        <div class="info-item">
                            <span>2023</span>
                            <span id="total2023">0 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</span>
                        </div>
                        <div class="info-item">
                            <span>2024</span>
                            <span id="total2024">0 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</span>
                        </div>
                    </div>
                    
                    <div class="info-card">
                        <h4>‚è∞ ‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á</h4>
                        <div class="info-item">
                            <span>17:00 - 19:00</span>
                            <span style="color: #f56565; font-weight: 600;">‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î</span>
                        </div>
                        <div class="info-item">
                            <span>07:00 - 09:00</span>
                            <span style="color: #ed8936; font-weight: 600;">‡∏™‡∏π‡∏á</span>
                        </div>
                        <div class="info-item">
                            <span>22:00 - 24:00</span>
                            <span style="color: #48bb78; font-weight: 600;">‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á</span>
                        </div>
                    </div>
                    
                    <div class="info-card">
                        <h4>‚ÑπÔ∏è ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</h4>
                        <div class="info-item">
                            <span>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</span>
                            <span id="totalAllYears">0 ‡∏à‡∏∏‡∏î</span>
                        </div>
                        <div class="info-item">
                            <span>‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏ï‡πà‡∏≠‡∏õ‡∏µ</span>
                            <span id="avgPerYear">0 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</span>
                        </div>
                        <div class="info-item">
                            <span>‡∏õ‡∏µ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î</span>
                            <span id="peakYear">-</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="script_dash.js"></script>
</body>
</html>
